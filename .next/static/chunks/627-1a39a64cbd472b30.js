"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[627],{63:(e,r,a)=>{var t=a(7260);a.o(t,"usePathname")&&a.d(r,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}})},1142:(e,r,a)=>{a.d(r,{m:()=>s});var t=a(5155);a(2115);var l=a(1433);let s=e=>{let{children:r,className:a,fluid:s=!1}=e;return(0,t.jsx)("div",{className:(0,l.cn)("w-full mx-auto px-4 md:px-6 py-6",!s&&"max-w-7xl",a),children:r})}},1390:(e,r,a)=>{a.d(r,{p:()=>o});var t=a(5155),l=a(2115),s=a(1433);let o=l.forwardRef((e,r)=>{let{className:a,label:l,error:o,leftIcon:i,rightIcon:n,rightElement:c,containerClassName:d,id:u,...m}=e,h=u||m.name;return(0,t.jsxs)("div",{className:(0,s.cn)("flex flex-col gap-2",d),children:[l&&(0,t.jsx)("label",{htmlFor:h,className:"text-[#111418] dark:text-white text-sm font-medium leading-normal",children:l}),(0,t.jsxs)("div",{className:"relative",children:[i&&(0,t.jsx)("div",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-[#92a4c9] pointer-events-none flex items-center justify-center",children:i}),(0,t.jsx)("input",{ref:r,id:h,className:(0,s.cn)("flex w-full min-w-0 resize-none overflow-hidden rounded-lg","bg-white dark:bg-[#111722]","border border-[#d1d5db] dark:border-[#324467]","text-[#111418] dark:text-white placeholder:text-[#92a4c9] text-base font-normal leading-normal","focus:outline-0 focus:ring-2 focus:ring-primary/50 focus:border-primary","transition-all duration-200","h-12 md:h-14",i?"pl-12":"pl-4",n||c?"pr-12":"pr-4",o?"border-red-500 focus:ring-red-500/50 focus:border-red-500":"",a),...m}),(n||c)&&(0,t.jsx)("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 text-[#92a4c9] flex items-center justify-center",children:c||n})]}),o&&(0,t.jsx)("p",{className:"text-red-500 text-xs mt-1 animate-pulse",children:o})]})});o.displayName="Input"},1433:(e,r,a)=>{a.d(r,{cn:()=>s});var t=a(2821),l=a(5889);function s(){for(var e=arguments.length,r=Array(e),a=0;a<e;a++)r[a]=arguments[a];return(0,l.QP)((0,t.$)(r))}},5132:(e,r,a)=>{a.d(r,{$:()=>o});var t=a(5155),l=a(2115),s=a(1433);let o=l.forwardRef((e,r)=>{let{className:a,variant:l="primary",size:o="md",isLoading:i=!1,leftIcon:n,rightIcon:c,children:d,disabled:u,fullWidth:m=!1,...h}=e;return(0,t.jsxs)("button",{ref:r,disabled:u||i,className:(0,s.cn)("inline-flex items-center justify-center rounded-lg font-bold leading-normal tracking-[0.015em] transition-all duration-200","focus:outline-none focus:ring-2 focus:ring-primary/50 focus:ring-offset-1 dark:focus:ring-offset-[#101622]","disabled:opacity-50 disabled:cursor-not-allowed active:scale-[0.98]","border",{primary:"bg-primary hover:bg-primary/90 text-white shadow-lg shadow-primary/20 border-transparent",secondary:"bg-white dark:bg-[#111722] border-slate-200 dark:border-[#324467] text-slate-900 dark:text-white hover:bg-slate-50 dark:hover:bg-[#232f48]",outline:"bg-transparent border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800",ghost:"bg-transparent border-transparent text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-white hover:bg-slate-100 dark:hover:bg-slate-800",danger:"bg-red-500/10 hover:bg-red-500/20 text-red-500 border-red-500/20"}[l],{sm:"h-9 px-3 text-xs",md:"h-12 md:h-14 px-6 text-sm md:text-base",lg:"h-14 px-8 text-base"}[o],m?"w-full":"",a),...h,children:[i&&(0,t.jsx)("span",{className:"mr-2 h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),!i&&n&&(0,t.jsx)("span",{className:"mr-2 flex items-center",children:n}),(0,t.jsx)("span",{className:"truncate",children:d}),!i&&c&&(0,t.jsx)("span",{className:"ml-2 flex items-center",children:c})]})});o.displayName="Button"},5626:(e,r,a)=>{a.d(r,{A:()=>t});let t=(0,a(1847).A)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},6132:(e,r,a)=>{a.d(r,{A:()=>t});let t=(0,a(1847).A)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},6472:(e,r,a)=>{a.d(r,{F:()=>l});var t=a(1136);class l{async upload(e,r){try{let{data:a,error:l}=await t.N.storage.from(this.bucket).upload(r,e,{cacheControl:"3600",upsert:!1});if(l)throw l;return this.getUrl(a.path)}catch(e){throw console.error("Erro no upload:",e),Error("Falha ao fazer upload do arquivo.")}}async delete(e){try{let r=this.extractPathFromUrl(e);if(!r)return void console.warn("URL inv\xe1lida ou arquivo n\xe3o pertence a este bucket:",e);let{error:a}=await t.N.storage.from(this.bucket).remove([r]);if(a)throw a}catch(e){throw console.error("Erro ao deletar arquivo:",e),Error("Falha ao remover arquivo do armazenamento.")}}getUrl(e){let{data:r}=t.N.storage.from(this.bucket).getPublicUrl(e);return r.publicUrl}async uploadVehicleImage(e,r){try{let a=e.name.split(".").pop(),t="".concat(Date.now(),"-").concat(Math.random().toString(36).substring(7),".").concat(a),l="".concat(r,"/").concat(t);return await this.upload(e,l)}catch(e){throw console.error("Erro no upload da imagem do ve\xedculo:",e),Error("Falha ao fazer upload da imagem do ve\xedculo.")}}async deleteVehicleImage(e){return this.delete(e)}getImageUrl(e){return this.getUrl(e)}async listVehicleImages(e){try{let{data:r,error:a}=await t.N.storage.from(this.bucket).list(e,{limit:100,offset:0,sortBy:{column:"name",order:"asc"}});if(a)throw a;return r?r.map(r=>this.getUrl("".concat(e,"/").concat(r.name))):[]}catch(e){return console.error("Erro ao listar imagens:",e),[]}}extractPathFromUrl(e){try{let r="/storage/v1/object/public/".concat(this.bucket,"/"),a=e.indexOf(r);if(-1!==a)return e.substring(a+r.length);return null}catch(e){return null}}constructor(){this.bucket="vehicles"}}},9129:(e,r,a)=>{a.d(r,{T:()=>d});var t=a(2115);class l{async execute(e){return this.vehicleRepository.create(e)}constructor(e){this.vehicleRepository=e}}class s{async execute(e){return this.vehicleRepository.findAll(e)}constructor(e){this.vehicleRepository=e}}class o{async execute(e,r){if(!e)throw Error("Vehicle ID is required");return this.vehicleRepository.update(e,r)}constructor(e){this.vehicleRepository=e}}class i{async execute(e){if(!e)throw Error("Vehicle ID is required");return this.vehicleRepository.findById(e)}constructor(e){this.vehicleRepository=e}}var n=a(334),c=a(6472);function d(){let{vehicleRepo:e}=(0,n.u)(),[r,a]=(0,t.useState)(null),[d,u]=(0,t.useState)(null),[m,h]=(0,t.useState)(!1),[x,p]=(0,t.useState)(null),b=(0,t.useMemo)(()=>new c.F,[]),v=(0,t.useMemo)(()=>new l(e),[e]),g=(0,t.useMemo)(()=>new s(e),[e]),f=(0,t.useMemo)(()=>new o(e),[e]),y=(0,t.useMemo)(()=>new i(e),[e]),j=(0,t.useCallback)(async e=>{h(!0),p(null);try{let r=await g.execute(e);a(r)}catch(e){p("Erro ao carregar ve\xedculos"),console.error(e)}finally{h(!1)}},[g]),k=(0,t.useCallback)(async e=>{h(!0),p(null);try{let r=await y.execute(e);return u(r),r}catch(e){return p("Erro ao buscar ve\xedculo"),console.error(e),null}finally{h(!1)}},[y]);return{vehicles:r,currentVehicle:d,isLoading:m,error:x,fetchVehicles:j,getVehicle:k,createVehicle:(0,t.useCallback)(async r=>{h(!0),p(null);try{let{vehicleImageFiles:a,...t}=r,l=await v.execute(t),s=[];if(a&&a.length>0)for(let e of a){let r=await b.uploadVehicleImage(e,l.id);s.push(r)}let o=[...(t.images||[]).map(e=>e.url),...s];return o.length>0&&await e.addImages(l.id,o),await y.execute(l.id)||l}catch(e){throw p("Erro ao criar ve\xedculo"),console.error(e),e}finally{h(!1)}},[v,b,e,y]),updateVehicle:(0,t.useCallback)(async(e,r)=>{h(!0),p(null);try{let a=await f.execute(e,r);return u(a),a}catch(e){throw p("Erro ao atualizar ve\xedculo"),console.error(e),e}finally{h(!1)}},[f])}}},9150:(e,r,a)=>{a.d(r,{x:()=>f});var t=a(5155),l=a(2115);let s=e=>{let{title:r,description:a,children:l}=e;return(0,t.jsx)("div",{className:"border-b border-slate-200 dark:border-slate-800 pb-8 mb-8 last:border-0 last:pb-0 last:mb-0",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,t.jsxs)("div",{className:"md:col-span-1",children:[(0,t.jsx)("h3",{className:"text-lg font-medium text-slate-900 dark:text-white mb-2",children:r}),a&&(0,t.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:a})]}),(0,t.jsx)("div",{className:"md:col-span-2 space-y-6",children:l})]})})};var o=a(1390);let i=e=>{let{label:r,error:a,helperText:l,className:s,...i}=e;return(0,t.jsxs)("div",{className:s,children:[(0,t.jsx)(o.p,{label:r,error:a,...i}),l&&!a&&(0,t.jsx)("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-400",children:l})]})},n=[{value:"GASOLINE",label:"Gasolina"},{value:"ETHANOL",label:"Etanol"},{value:"DIESEL",label:"Diesel"},{value:"FLEX",label:"Flex"},{value:"HYBRID",label:"H\xedbrido"},{value:"ELECTRIC",label:"El\xe9trico"}],c=[{value:"MANUAL",label:"Manual"},{value:"AUTOMATIC",label:"Autom\xe1tico"},{value:"CVT",label:"CVT"},{value:"AUTOMATED",label:"Automatizado"}],d=e=>{let{data:r,onChange:a,errors:l}=e;return(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,t.jsx)(i,{label:"Marca",placeholder:"Ex: Toyota",value:r.make||"",onChange:e=>a("make",e.target.value),error:null==l?void 0:l.make}),(0,t.jsx)(i,{label:"Modelo",placeholder:"Ex: Corolla",value:r.model||"",onChange:e=>a("model",e.target.value),error:null==l?void 0:l.model}),(0,t.jsx)(i,{label:"Vers\xe3o",placeholder:"Ex: XEi 2.0",value:r.version||"",onChange:e=>a("version",e.target.value),error:null==l?void 0:l.version}),(0,t.jsx)(i,{label:"Cor",placeholder:"Ex: Prata",value:r.color||"",onChange:e=>a("color",e.target.value),error:null==l?void 0:l.color}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("label",{className:"text-[#111418] dark:text-white text-sm font-medium leading-normal",children:"Combust\xedvel"}),(0,t.jsxs)("select",{className:"flex w-full h-12 md:h-14 px-4 rounded-lg bg-white dark:bg-[#111722] border border-[#d1d5db] dark:border-[#324467] text-[#111418] dark:text-white",value:r.fuel||"",onChange:e=>a("fuel",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Selecione..."}),n.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]}),(null==l?void 0:l.fuel)&&(0,t.jsx)("p",{className:"text-red-500 text-xs mt-1",children:l.fuel})]}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("label",{className:"text-[#111418] dark:text-white text-sm font-medium leading-normal",children:"C\xe2mbio"}),(0,t.jsxs)("select",{className:"flex w-full h-12 md:h-14 px-4 rounded-lg bg-white dark:bg-[#111722] border border-[#d1d5db] dark:border-[#324467] text-[#111418] dark:text-white",value:r.transmission||"",onChange:e=>a("transmission",e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Selecione..."}),c.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]}),(null==l?void 0:l.transmission)&&(0,t.jsx)("p",{className:"text-red-500 text-xs mt-1",children:l.transmission})]}),(0,t.jsx)(i,{label:"Ano Fabrica\xe7\xe3o",type:"number",placeholder:"Ex: 2021",value:r.yearManufacture||"",onChange:e=>a("yearManufacture",parseInt(e.target.value)),error:null==l?void 0:l.yearManufacture}),(0,t.jsx)(i,{label:"Ano Modelo",type:"number",placeholder:"Ex: 2022",value:r.yearModel||"",onChange:e=>a("yearModel",parseInt(e.target.value)),error:null==l?void 0:l.yearModel}),(0,t.jsx)(i,{label:"Quilometragem",type:"number",placeholder:"Ex: 45000",value:r.mileage||"",onChange:e=>a("mileage",parseInt(e.target.value)),error:null==l?void 0:l.mileage}),(0,t.jsx)(i,{label:"Placa (Final)",placeholder:"Ex: 9B12",value:r.plateEnd||"",onChange:e=>a("plateEnd",e.target.value),error:null==l?void 0:l.plateEnd}),(0,t.jsx)(i,{label:"Chassi (VIN)",placeholder:"Digite o chassi completo",className:"md:col-span-2",value:r.chassisNumber||"",onChange:e=>a("chassisNumber",e.target.value),error:null==l?void 0:l.chassisNumber})]})};var u=a(1847);let m=(0,u.A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),h=(0,u.A)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),x=e=>{let{images:r,onUpload:a,onRemove:s}=e,o=(0,l.useRef)(null);return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",onClick:()=>{var e;return null==(e=o.current)?void 0:e.click()},children:[(0,t.jsx)("div",{className:"p-4 rounded-full bg-primary/10 text-primary mb-4",children:(0,t.jsx)(m,{size:24})}),(0,t.jsx)("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:"Clique para fazer upload"}),(0,t.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:"SVG, PNG, JPG ou GIF (max. 10MB)"}),(0,t.jsx)("input",{ref:o,type:"file",multiple:!0,className:"hidden",accept:"image/*",onChange:e=>{e.target.files&&e.target.files.length>0&&a(Array.from(e.target.files))}})]}),(0,t.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.map((e,r)=>(0,t.jsxs)("div",{className:"relative group aspect-video rounded-lg overflow-hidden bg-slate-100 dark:bg-slate-800 border border-slate-200 dark:border-slate-700",children:[(0,t.jsx)("img",{src:e,alt:"Preview ".concat(r),className:"w-full h-full object-cover"}),(0,t.jsx)("button",{type:"button",onClick:()=>s(r),className:"absolute top-2 right-2 p-1.5 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity transform scale-90 group-hover:scale-100",children:(0,t.jsx)(h,{size:14})})]},r))})]})};var p=a(5132),b=a(6132);let v=e=>{let{message:r}=e;return r?(0,t.jsxs)("div",{className:"flex items-center gap-2 p-3 rounded-lg bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm mt-2",children:[(0,t.jsx)(b.A,{size:16}),(0,t.jsx)("span",{children:r})]}):null},g=(0,u.A)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),f=e=>{var r;let{initialData:a,onSubmit:o,isLoading:i}=e,[n,c]=(0,l.useState)(a||{images:[]}),[u,m]=(0,l.useState)({}),h=(e,r)=>{c(a=>({...a,[e]:r})),u[e]&&m(r=>{let a={...r};return delete a[e],a})},b=async e=>{e.preventDefault(),(()=>{let e={};return n.make||(e.make="Marca \xe9 obrigat\xf3ria"),n.model||(e.model="Modelo \xe9 obrigat\xf3rio"),n.yearManufacture||(e.yearManufacture="Ano Fab. \xe9 obrigat\xf3rio"),n.chassisNumber||(e.chassisNumber="Chassi \xe9 obrigat\xf3rio"),m(e),0===Object.keys(e).length})()&&await o(n)};return(0,t.jsxs)("form",{onSubmit:b,className:"space-y-8",children:[(0,t.jsx)(s,{title:"Informa\xe7\xf5es do Ve\xedculo",description:"Dados b\xe1sicos e t\xe9cnicos do ve\xedculo.",children:(0,t.jsx)(d,{data:n,onChange:h,errors:u})}),(0,t.jsx)(s,{title:"Fotos e Documentos",description:"Adicione fotos do ve\xedculo. A primeira ser\xe1 a capa.",children:(0,t.jsx)(x,{images:(null==(r=n.images)?void 0:r.map(e=>e.url))||[],onUpload:e=>{let r=e.map(e=>URL.createObjectURL(e)),a=n.images||[],t=n.vehicleImageFiles||[];h("images",[...a,...r.map(e=>({id:"temp-".concat(Date.now(),"-").concat(Math.random()),url:e,isCover:!1}))]),h("vehicleImageFiles",[...t,...e])},onRemove:e=>{let r=[...n.images||[]],a=[...n.vehicleImageFiles||[]];r.splice(e,1),a.splice(e,1),h("images",r),h("vehicleImageFiles",a)}})}),(0,t.jsx)("div",{className:"flex justify-end pt-6 border-t border-slate-200 dark:border-slate-800",children:(0,t.jsxs)(p.$,{type:"submit",disabled:i,className:"w-full md:w-auto",children:[(0,t.jsx)(g,{size:18,className:"mr-2"}),"Salvar Ve\xedculo"]})}),Object.keys(u).length>0&&(0,t.jsx)(v,{message:"Por favor, corrija os erros acima antes de salvar."})]})}}}]);